
# 快速傅里叶变换库（FFTW库）

[FFTW官网](http://www.fftw.org/download.html)

[FFT的计算—（使用FFTW库）](https://www.jianshu.com/p/0d606acf97a0)

```shell
# 编译安装到系统
./configure
make
make install

# 编译安装到指定目录
./configure --prefix=$PWD/install
make
make install
```

对比python的fft结果测试：

fftw库：

```c
void main_init(int *argc, char ***argv)
{
    int N = 32;
    fftw_complex *in, *out;
    fftw_plan p;
    
    in = (fftw_complex*)fftw_malloc(sizeof(fftw_complex) * N);
    out = (fftw_complex*)fftw_malloc(sizeof(fftw_complex) * N);

    for (int i = 0; i < N; i++)
    {
        in[i][0] = i;
        in[i][1] = 0;
    }

    p = fftw_plan_dft_1d(N, in, out, FFTW_FORWARD, FFTW_ESTIMATE);
    
    fftw_execute(p); /* repeat as needed */

    for (int i = 0; i < N; i++)
    {
		printf("%f %f\r\n", out[i][0], out[i][1]);
    }
    
    fftw_destroy_plan(p);
    fftw_free(in); 
    fftw_free(out);
}
```

结果：

> 496.000000 0.000000
> -16.000000 162.450726
> -16.000000 80.437432
> -16.000000 52.744931
> -16.000000 38.627417
> -16.000000 29.933895
> -16.000000 23.945692
> -16.000000 19.496056
> -16.000000 16.000000
> -16.000000 13.130861
> -16.000000 10.690858
> -16.000000 8.552178
> -16.000000 6.627417
> -16.000000 4.853547
> -16.000000 3.182598
> -16.000000 1.575862
> -16.000000 0.000000
> -16.000000 -1.575862
> -16.000000 -3.182598
> -16.000000 -4.853547
> -16.000000 -6.627417
> -16.000000 -8.552178
> -16.000000 -10.690858
> -16.000000 -13.130861
> -16.000000 -16.000000
> -16.000000 -19.496056
> -16.000000 -23.945692
> -16.000000 -29.933895
> -16.000000 -38.627417
> -16.000000 -52.744931
> -16.000000 -80.437432
> -16.000000 -162.450726

python:

```python
import scipy.fftpack as fftpack
import numpy as np

x = np.arange(0, 32)

y = fftpack.fft(x, 32)    # fft方法1
# y = np.fft.rfft(x, 32)      # fft方法2

y_real = np.real(y)         # 输出实部
y_imag = np.imag(y)         # 输出虚部

print("input", x, "\r\n")

for i in range(32):
    print(y_real[i], " ", y_imag[i])
```

结果:

> 496.0   -0.0
> -15.999999999999998   162.45072620174176
> -16.0   80.43743187401355
> -16.000000000000004   52.74493134301312
> -15.999999999999998   38.62741699796952
> -16.0   29.93389458863023
> -16.0   23.945692202647827
> -15.999999999999995   19.496056409407622
> -16.0   16.0
> -16.000000000000004   13.130860653258559
> -16.0   10.690858206708782
> -16.0   8.552178175212667
> -16.0   6.627416997969519
> -15.999999999999996   4.8535469377174785
> -16.0   3.1825978780745245
> -15.999999999999998   1.5758624537146204
> -16.0   -0.0
> -15.999999999999998   -1.5758624537146204
> -16.0   -3.1825978780745245
> -15.999999999999996   -4.8535469377174785
> -16.0   -6.627416997969519
> -16.0   -8.552178175212667
> -16.0   -10.690858206708782
> -16.000000000000004   -13.130860653258559
> -16.0   -16.0
> -15.999999999999995   -19.496056409407622
> -16.0   -23.945692202647827
> -16.0   -29.93389458863023
> -15.999999999999998   -38.62741699796952
> -16.000000000000004   -52.74493134301312
> -16.0   -80.43743187401355
> -15.999999999999998   -162.45072620174176


